set(ANDROID_EMUGL_DIR ${CMAKE_CURRENT_SOURCE_DIR})
set(GOLDFISH_EMUGL_DIR
    ${ANDROID_QEMU2_TOP_DIR}/../../device/generic/goldfish-opengl/)
set(GFXSTREAM_REPO_ROOT ${ANDROID_QEMU2_TOP_DIR}/../../hardware/google/gfxstream)

# We start of defining an interface library that defines all the compiler
# settings we wish to use for all libs. please keep this at a bare minimum!
android_add_interface(TARGET emugl_base LICENSE Apache-2.0)
target_compile_definitions(emugl_base INTERFACE "-DEMUGL_BUILD=1")
if(CMAKE_BUILD_TYPE STREQUAL "Debug")
  target_compile_definitions(emugl_base INTERFACE "-DEMUGL_DEBUG=1")
endif()

target_link_libraries(emugl_base INTERFACE android-emu-base-headers qemu-host-common-headers)

# TODO(jansene): The libraries included below are autogenerated, and requires
# these:
if(CMAKE_CXX_COMPILER_ID STREQUAL "Clang")
  add_c_flag("-Wno-return-type")
  add_c_flag("-Wno-unused-value")
  add_c_flag("-Wno-inconsistent-missing-override")
  add_c_flag("-Wno-deprecated-declarations")
  add_c_flag("-Wno-reorder-init-list")
endif()

if(NOT OPTION_GFXSTREAM_BACKEND)
  add_subdirectory(shared/OpenglCodecCommon)
endif()

add_subdirectory(shared/emugl/common)

if(NOT WINDOWS AND NOT BUILDING_FOR_AARCH64)
  if (NOT OPTION_GFXSTREAM_BACKEND)
    add_subdirectory(guest)
  endif()
endif()

add_subdirectory(combined)
